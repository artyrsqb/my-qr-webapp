<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
      color: #333;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .container {
      width: 100%;
      max-width: 600px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      padding: 30px;
      text-align: center;
    }

    h1 {
      color: #2c3e50;
      margin-bottom: 20px;
      font-size: 2rem;
    }

    p {
      color: #7f8c8d;
      margin-bottom: 30px;
    }

    .upload-area {
      border: 2px dashed #3498db;
      border-radius: 8px;
      padding: 40px;
      background-color: #f8f9fa;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .upload-area:hover {
      background-color: #e3f2fd;
      border-color: #2980b9;
    }

    .upload-area p {
      margin: 0;
      font-size: 1.1rem;
      color: #3498db;
    }

    input[type="file"] {
      display: none;
    }

    .controls {
      margin: 25px 0;
    }

    label {
      font-weight: bold;
      color: #2c3e50;
      margin-right: 10px;
    }

    select, button {
      padding: 12px 20px;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #ddd;
    }

    button {
      background: #3498db;
      color: white;
      border: none;
      cursor: pointer;
      margin-left: 10px;
      transition: background 0.3s;
    }

    button:hover {
      background: #2980b9;
    }

    #preview-container {
      margin: 20px auto;
      display: none;
    }

    #preview {
      max-width: 100%;
      max-height: 300px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    #download {
      display: none;
      margin-top: 20px;
      padding: 12px 20px;
      background: #2ecc71;
      color: white;
      text-decoration: none;
      border-radius: 6px;
      font-weight: bold;
    }

    #download:hover {
      background: #27ae60;
    }

    .progress {
      height: 8px;
      background: #ecf0f1;
      border-radius: 4px;
      overflow: hidden;
      margin: 20px 0;
      display: none;
    }

    .progress-bar {
      height: 100%;
      background: #3498db;
      width: 0%;
      transition: width 0.3s;
    }
  </style>
</head>
<body>

<div class="container">
  <h1>üñº –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</h1>
  <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç –∏ —Å–∫–∞—á–∞–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç</p>

  <!-- –û–±–ª–∞—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ -->
  <label for="upload" class="upload-area">
    <p>üìÅ –ù–∞–∂–º–∏—Ç–µ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</p>
  </label>
  <input type="file" id="upload" accept="image/*" />

  <!-- –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
  <div class="controls">
    <label for="format">–§–æ—Ä–º–∞—Ç:</label>
    <select id="format">
      <option value="image/jpeg">JPEG</option>
      <option value="image/png">PNG</option>
      <option value="image/webp">WebP</option>
    </select>
    <button onclick="convert()">üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
  </div>

  <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å -->
  <div class="progress">
    <div class="progress-bar" id="progress-bar"></div>
  </div>

  <!-- –ü—Ä–µ–≤—å—é -->
  <div id="preview-container">
    <img id="preview" alt="Preview" />
  </div>

  <!-- –°—Å—ã–ª–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è -->
  <a id="download">üì• –°–∫–∞—á–∞—Ç—å</a>
</div>

<script>
  let originalFile;

  document.getElementById('upload').addEventListener('change', function(e) {
    originalFile = e.target.files[0];
    if (!originalFile) return;

    const reader = new FileReader();
    reader.onload = function(event) {
      const img = document.getElementById('preview');
      img.src = event.target.result;
      document.getElementById('preview-container').style.display = 'block';
    };
    reader.readAsDataURL(originalFile);
  });

  function convert() {
    if (!originalFile) {
      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ');
      return;
    }

    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    const img = document.getElementById('preview');

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
    const progressBar = document.getElementById('progress-bar');
    const progressContainer = document.querySelector('.progress');
    progressContainer.style.display = 'block';

    // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∞)
    let width = 0;
    const interval = setInterval(() => {
      width += 5;
      progressBar.style.width = `${width}%`;
      if (width >= 100) {
        clearInterval(interval);

        // –†–∏—Å—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ canvas
        canvas.width = img.naturalWidth;
        canvas.height = img.naturalHeight;
        ctx.drawImage(img, 0, 0);

        const format = document.getElementById('format').value;
        const dataURL = canvas.toDataURL(format);

        const link = document.getElementById('download');
        link.href = dataURL;
        link.download = `converted.${format.split('/')[1]}`;
        link.textContent = `üì• –°–∫–∞—á–∞—Ç—å ${format.split('/')[1].toUpperCase()}`;
        link.style.display = 'inline-block';
      }
    }, 50);
  }
</script>

</body>
</html>

