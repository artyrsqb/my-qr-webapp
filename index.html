<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#24272b" id="theme-color">
    <title>Font Changer –¥–ª—è Telegram</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --tg-theme-bg-color: #ffffff;
            --tg-theme-text-color: #000000;
            --tg-theme-hint-color: #999999;
            --tg-theme-link-color: #2678b6;
            --tg-theme-button-color: #2678b6;
            --tg-theme-button-text-color: #ffffff;
            --primary-color: #2678b6;
            --secondary-color: #667eea;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --border-radius: 16px;
            --spacing: 16px;
            --card-bg: rgba(0, 0, 0, 0.04);
            --card-border: rgba(0, 0, 0, 0.08);
            --selected-card-bg: rgba(38, 120, 182, 0.12);
            --selected-card-border: rgba(38, 120, 182, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            -webkit-font-smoothing: antialiased;
            height: 100vh;
            overflow-y: auto;
            overscroll-behavior: none;
            line-height: 1.5;
        }

        .container {
            max-width: 100%;
            padding: var(--spacing);
            padding-bottom: 90px;
        }

        .header {
            text-align: center;
            margin-bottom: var(--spacing);
            padding-top: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--card-border);
        }

        .logo {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 6px;
            background: linear-gradient(90deg, var(--secondary-color), var(--primary-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .subtitle {
            color: var(--tg-theme-hint-color);
            font-size: 15px;
            margin-top: 4px;
        }

        .input-section {
            margin-bottom: var(--spacing);
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 16px;
            border: 1px solid var(--card-border);
        }

        textarea {
            width: 100%;
            padding: 14px;
            border: 1px solid var(--card-border);
            border-radius: 14px;
            font-size: 17px;
            resize: none;
            background-color: rgba(0, 0, 0, 0.06);
            color: var(--tg-theme-text-color);
            font-family: inherit;
            transition: all 0.2s;
            min-height: 100px;
            max-height: 200px;
            line-height: 1.5;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(38, 120, 182, 0.2);
            background-color: rgba(0, 0, 0, 0.08);
        }

        .input-hint {
            font-size: 13px;
            color: var(--tg-theme-hint-color);
            margin-top: 8px;
            text-align: center;
            font-weight: 500;
        }

        .preview-section {
            margin-bottom: var(--spacing);
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 18px;
            border: 1px solid var(--card-border);
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--card-border);
        }

        .preview-title {
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .preview-text {
            font-size: 22px;
            min-height: 48px;
            line-height: 1.4;
            word-break: break-word;
            padding: 4px 0;
            font-weight: 500;
        }

        .preview-placeholder {
            color: var(--tg-theme-hint-color);
            font-style: italic;
        }

        .styles-section {
            margin-bottom: var(--spacing);
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .styles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 12px;
        }

        .style-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 14px 10px;
            text-align: center;
            transition: all 0.2s;
            border: 2px solid transparent;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100px;
            position: relative;
        }

        .style-card:hover {
            background: rgba(38, 120, 182, 0.06);
            transform: translateY(-1px);
        }

        .style-card.selected {
            background: var(--selected-card-bg);
            border-color: var(--primary-color);
            box-shadow: 0 4px 12px rgba(38, 120, 182, 0.15);
        }

        .style-card.selected::after {
            content: "‚úì";
            position: absolute;
            top: 6px;
            right: 8px;
            width: 22px;
            height: 22px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .style-name {
            font-weight: 600;
            font-size: 14px;
            margin-top: 8px;
            display: block;
            min-height: 24px;
        }

        .style-example {
            font-size: 18px;
            font-weight: 500;
            margin-top: 4px;
            line-height: 1.3;
            min-height: 28px;
        }

        .popular-badge {
            position: absolute;
            top: 6px;
            left: 6px;
            background: var(--warning-color);
            color: white;
            font-size: 10px;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 10px;
            z-index: 2;
        }

        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: var(--spacing);
            background: var(--tg-theme-bg-color);
            border-top: 1px solid var(--card-border);
            box-shadow: 0 -2px 12px rgba(0, 0, 0, 0.08);
            z-index: 100;
            padding-bottom: calc(var(--spacing) + env(safe-area-inset-bottom));
        }

        .main-button {
            width: 100%;
            padding: 16px;
            background: var(--tg-theme-button-color, var(--primary-color));
            color: var(--tg-theme-button-text-color, white);
            border: none;
            border-radius: 16px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.18);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .main-button:disabled {
            opacity: 0.65;
            cursor: default;
            transform: none;
            box-shadow: none;
        }

        .main-button:not(:disabled):active {
            transform: scale(0.985);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .toast {
            position: fixed;
            bottom: 90px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 12px 24px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 500;
            opacity: 0;
            transition: all 0.35s ease;
            z-index: 1000;
            pointer-events: none;
            max-width: 85%;
            text-align: center;
            line-height: 1.4;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .instructions {
            background: rgba(38, 120, 182, 0.08);
            border-left: 4px solid var(--primary-color);
            border-radius: 0 12px 12px 0;
            padding: 14px;
            margin: 20px 0;
            font-size: 14px;
        }

        .instructions ol {
            padding-left: 20px;
            margin-top: 8px;
        }

        .instructions li {
            margin-bottom: 4px;
        }

        .app-hint {
            text-align: center;
            font-size: 13px;
            color: var(--tg-theme-hint-color);
            margin-top: 8px;
            font-weight: 500;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
        @media (max-width: 360px) {
            .container {
                padding: 12px;
                padding-bottom: 85px;
            }
            
            .styles-grid {
                grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            }
            
            .logo {
                font-size: 26px;
            }
            
            .main-button {
                padding: 18px 16px;
                font-size: 17px;
            }
            
            .preview-text {
                font-size: 20px;
            }
            
            .style-example {
                font-size: 17px;
            }
        }

        /* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
        [data-theme="dark"] {
            --tg-theme-bg-color: #17181a;
            --tg-theme-text-color: #f0f0f0;
            --tg-theme-hint-color: #858585;
            --tg-theme-link-color: #5ea9e9;
            --tg-theme-button-color: #5ea9e9;
            --tg-theme-button-text-color: #ffffff;
            --card-bg: rgba(255, 255, 255, 0.06);
            --card-border: rgba(255, 255, 255, 0.1);
            --selected-card-bg: rgba(94, 169, 233, 0.15);
            --selected-card-border: rgba(94, 169, 233, 0.5);
        }

        [data-theme="dark"] textarea {
            background-color: rgba(255, 255, 255, 0.08);
            border-color: var(--card-border);
        }

        [data-theme="dark"] textarea:focus {
            background-color: rgba(255, 255, 255, 0.1);
        }

        [data-theme="dark"] .preview-section,
        [data-theme="dark"] .input-section,
        [data-theme="dark"] .style-card {
            background: var(--card-bg);
            border-color: var(--card-border);
        }

        [data-theme="dark"] .footer {
            border-top-color: var(--card-border);
            box-shadow: 0 -2px 12px rgba(0, 0, 0, 0.3);
        }

        [data-theme="dark"] .instructions {
            background: rgba(94, 169, 233, 0.1);
            border-left-color: var(--tg-theme-link-color);
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(38, 120, 182, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(38, 120, 182, 0); }
            100% { box-shadow: 0 0 0 0 rgba(38, 120, 182, 0); }
        }

        .style-card.selected {
            animation: pulse 1.5s infinite;
        }

        @media (prefers-reduced-motion) {
            .style-card.selected {
                animation: none;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="app-container">
        <div class="header">
            <div class="logo">‚ú® Font Changer</div>
            <p class="subtitle">–°—Ç–∏–ª–∏–∑—É–π—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Telegram</p>
        </div>

        <div class="input-section">
            <textarea id="inputText" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–¥–µ—Å—å...">–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä!</textarea>
            <div class="input-hint">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –±–∞–∑–æ–≤—ã–µ —Å–∏–º–≤–æ–ª—ã</div>
        </div>

        <div class="preview-section">
            <div class="preview-header">
                <div class="preview-title">üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</div>
                <div id="selectedStyleName" class="style-name" style="font-weight: 500; color: var(--primary-color);">–ñ–∏—Ä–Ω—ã–π</div>
            </div>
            <div id="previewText" class="preview-text">ùóõùó≤ùóπùóπùóº, ùó™ùóºùóøùóπùó±!</div>
        </div>

        <div class="instructions">
            <div style="font-weight: 600; margin-bottom: 6px;">–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</div>
            <ol>
                <li>–í–≤–µ–¥–∏—Ç–µ –∏–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç</li>
                <li>–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–π—Å—è —Å—Ç–∏–ª—å</li>
                <li>–ù–∞–∂–º–∏—Ç–µ ¬´–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ —á–∞—Ç¬ª</li>
            </ol>
        </div>

        <div class="styles-section">
            <div class="section-title">üé® –í—ã–±–µ—Ä–∏—Ç–µ —à—Ä–∏—Ñ—Ç</div>
            <div class="styles-grid" id="stylesGrid">
                <!-- –°—Ç–∏–ª–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </div>

        <div class="app-hint">
            –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Telegram.<br>–û—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.
        </div>
    </div>

    <div class="footer">
        <button id="mainBtn" class="main-button">
            <span>üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ —á–∞—Ç</span>
        </button>
    </div>

    <div class="toast" id="toast">‚úì –°—Ç–∏–ª—å –≤—ã–±—Ä–∞–Ω! –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏</div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        const WebApp = window.Telegram?.WebApp;
        let selectedStyle = 'bold';
        const exampleText = "Hello";
        const defaultText = "–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä!";
        
        // –°–ª–æ–≤–∞—Ä—å —Å—Ç–∏–ª–µ–π —Å Unicode-–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è–º–∏
        const fontStyles = {
            bold: { 
                name: "–ñ–∏—Ä–Ω—ã–π", 
                transform: t => t.replace(/[a-zA-Z0-9]/g, c => {
                    const code = c.charCodeAt(0);
                    if (c >= 'a' && c <= 'z') return String.fromCodePoint(code - 97 + 0x1D5D4);
                    if (c >= 'A' && c <= 'Z') return String.fromCodePoint(code - 65 + 0x1D5A0);
                    if (c >= '0' && c <= '9') return String.fromCodePoint(code - 48 + 0x1D7CE);
                    return c;
                }),
                popular: true
            },
            italic: { 
                name: "–ö—É—Ä—Å–∏–≤", 
                transform: t => t.replace(/[a-zA-Z]/g, c => {
                    const code = c.charCodeAt(0);
                    if (c >= 'a' && c <= 'z') return String.fromCodePoint(code - 97 + 0x1D622);
                    if (c >= 'A' && c <= 'Z') return String.fromCodePoint(code - 65 + 0x1D608);
                    return c;
                })
            },
            script: { 
                name: "–†—É–∫–æ–ø–∏—Å–Ω—ã–π", 
                transform: t => t.replace(/[a-zA-Z]/g, c => {
                    const code = c.charCodeAt(0);
                    if (c >= 'a' && c <= 'z') return String.fromCodePoint(code - 97 + 0x1D4B6);
                    if (c >= 'A' && c <= 'Z') return String.fromCodePoint(code - 65 + 0x1D49C);
                    return c;
                }),
                popular: true
            },
            fraktur: { 
                name: "–ì–æ—Ç–∏—á–µ—Å–∫–∏–π", 
                transform: t => t.replace(/[a-zA-Z]/g, c => {
                    const code = c.charCodeAt(0);
                    if (c >= 'a' && c <= 'z') return String.fromCodePoint(code - 97 + 0x1D51E);
                    if (c >= 'A' && c <= 'Z') return String.fromCodePoint(code - 65 + 0x1D504);
                    return c;
                })
            },
            monospace: { 
                name: "–ú–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–π", 
                transform: t => t.replace(/[a-zA-Z0-9]/g, c => {
                    const code = c.charCodeAt(0);
                    if (c >= 'a' && c <= 'z') return String.fromCodePoint(code - 97 + 0x1D670);
                    if (c >= 'A' && c <= 'Z') return String.fromCodePoint(code - 65 + 0x1D656);
                    if (c >= '0' && c <= '9') return String.fromCodePoint(code - 48 + 0x1D7F6);
                    return c;
                }),
                popular: true
            },
            doubleStruck: { 
                name: "–î–≤–æ–π–Ω–æ–π", 
                transform: t => t.replace(/[a-zA-Z0-9]/g, c => {
                    const code = c.charCodeAt(0);
                    if (c >= 'a' && c <= 'z') return String.fromCodePoint(code - 97 + 0x1D552);
                    if (c >= 'A' && c <= 'Z') return String.fromCodePoint(code - 65 + 0x1D538);
                    if (c >= '0' && c <= '9') return String.fromCodePoint(code - 48 + 0x1D7D8);
                    return c;
                })
            },
            smallCaps: { 
                name: "–ö–∞–ø–∏—Ç–µ–ª—å", 
                transform: t => t.replace(/[a-z]/g, c => {
                    const code = c.charCodeAt(0);
                    return String.fromCodePoint(code - 97 + 0x1D00);
                })
            },
            circled: { 
                name: "–í –∫—Ä—É–∂–∫–∞—Ö", 
                transform: t => t.replace(/[a-z0-9]/g, c => {
                    const code = c.charCodeAt(0);
                    if (c >= 'a' && c <= 'z') return String.fromCodePoint(code - 97 + 0x24D0);
                    if (c >= '0' && c <= '9') return String.fromCodePoint(code - 48 + 0x2460);
                    return c;
                })
            },
            squared: { 
                name: "–í –∫–≤–∞–¥—Ä–∞—Ç–∞—Ö", 
                transform: t => t.replace(/[a-z]/g, c => {
                    const code = c.charCodeAt(0);
                    return String.fromCodePoint(code - 97 + 0x1F130);
                })
            },
            bubble: { 
                name: "–ü—É–∑—ã—Ä—å–∫–∏", 
                transform: t => t.replace(/[a-zA-Z0-9]/g, c => {
                    const code = c.charCodeAt(0);
                    if (c >= 'a' && c <= 'z') return String.fromCodePoint(code - 97 + 0x1F150);
                    if (c >= 'A' && c <= 'Z') return String.fromCodePoint(code - 65 + 0x1F130);
                    if (c >= '0' && c <= '9') return String.fromCodePoint(code - 48 + 0x24EA);
                    return c;
                }),
                popular: true
            },
            upsideDown: { 
                name: "–í–≤–µ—Ä—Ö –Ω–æ–≥–∞–º–∏", 
                transform: t => {
                    const map = {
                        'a':'…ê','b':'q','c':'…î','d':'p','e':'«ù','f':'…ü','g':'∆É','h':'…•','i':'·¥â','j':'…æ','k':' û','l':' É',
                        'm':'…Ø','n':'u','o':'o','p':'d','q':'b','r':'…π','s':'s','t':' á','u':'n','v':' å','w':' ç','x':'x',
                        'y':' é','z':'z','A':'‚àÄ','B':'êêí','C':'∆Ü','D':'‚óñ','E':'∆é','F':'‚Ñ≤','G':'‚ÖÅ','H':'H','I':'I','J':'≈ø',
                        'K':'‚ãä','L':'À•','M':'W','N':'N','O':'O','P':'‘Ä','Q':'Œå','R':'·¥ö','S':'S','T':'‚ä•','U':'‚à©','V':'Œõ',
                        'W':'M','X':'X','Y':'‚ÖÑ','Z':'Z','0':'0','1':'∆ñ','2':'·ÑÖ','3':'∆ê','4':'„Ñ£','5':'œõ','6':'9','7':'„Ñ•',
                        '8':'8','9':'6','.':'Àô',',':"'","'":',','"':',,','`':',','?':'¬ø','!':'¬°','(':'(',')':')','[':']',
                        ']':'[','{':'}','}':'{','<':'>','>':'<','&':'‚Öã','_':'‚Äæ',' ':' '
                    };
                    return t.split('').map(c => map[c] || c).reverse().join('');
                }
            },
            superscript: {
                name: "–í–µ—Ä—Ö–Ω–∏–π –∏–Ω–¥–µ–∫—Å",
                transform: t => t.replace(/[a-zA-Z0-9]/g, c => {
                    const superscriptMap = {
                        '0':'‚Å∞','1':'¬π','2':'¬≤','3':'¬≥','4':'‚Å¥','5':'‚Åµ','6':'‚Å∂','7':'‚Å∑','8':'‚Å∏','9':'‚Åπ',
                        'a':'·µÉ','b':'·µá','c':'·∂ú','d':'·µà','e':'·µâ','f':'·∂†','g':'·µç','h':' ∞','i':'‚Å±','j':' ≤',
                        'k':'·µè','l':'À°','m':'·µê','n':'‚Åø','o':'·µí','p':'·µñ','r':' ≥','s':'À¢','t':'·µó','u':'·µò',
                        'v':'·µõ','w':' ∑','x':'À£','y':' ∏','z':'·∂ª','A':'·¥¨','B':'·¥Æ','D':'·¥∞','E':'·¥±','G':'·¥≥',
                        'H':'·¥¥','I':'·¥µ','J':'·¥∂','K':'·¥∑','L':'·¥∏','M':'·¥π','N':'·¥∫','O':'·¥º','P':'·¥æ','R':'·¥ø',
                        'T':'·µÄ','U':'·µÅ','V':'‚±Ω','W':'·µÇ','X':'À£','Y':' ∏'
                    };
                    return superscriptMap[c] || c;
                })
            }
        };

        // –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        function escapeHtml(str) {
            if (!str) return '';
            return str.replace(/[&<>"']/g, m => ({
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#39;'
            })[m]);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showToast(message = '‚úì –°—Ç–∏–ª—å –≤—ã–±—Ä–∞–Ω!') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2500);
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
        function updatePreview() {
            const inputText = document.getElementById('inputText').value.trim();
            const previewTextEl = document.getElementById('previewText');
            const selectedStyleNameEl = document.getElementById('selectedStyleName');
            
            if (!inputText) {
                previewTextEl.textContent = "–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞";
                previewTextEl.className = "preview-text preview-placeholder";
                return;
            }
            
            const transformed = fontStyles[selectedStyle].transform(inputText);
            previewTextEl.textContent = transformed;
            previewTextEl.className = "preview-text";
            selectedStyleNameEl.textContent = fontStyles[selectedStyle].name;
        }

        // –°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∏–ª–µ–π
        function renderStyleCards() {
            const stylesGrid = document.getElementById('stylesGrid');
            stylesGrid.innerHTML = '';
            
            Object.entries(fontStyles).forEach(([key, style]) => {
                const example = style.transform(exampleText);
                const card = document.createElement('div');
                card.className = `style-card ${selectedStyle === key ? 'selected' : ''}`;
                card.dataset.style = key;
                
                if (style.popular) {
                    card.innerHTML = `<div class="popular-badge">–¢–û–ü</div>`;
                }
                
                card.innerHTML += `
                    <div class="style-example">${escapeHtml(example)}</div>
                    <span class="style-name">${style.name}</span>
                `;
                
                card.addEventListener('click', () => {
                    // –£–±—Ä–∞—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –∫–∞—Ä—Ç
                    document.querySelectorAll('.style-card').forEach(c => {
                        c.classList.remove('selected');
                    });
                    
                    // –í—ã–¥–µ–ª–∏—Ç—å —Ç–µ–∫—É—â—É—é
                    card.classList.add('selected');
                    selectedStyle = key;
                    
                    // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
                    updatePreview();
                    
                    // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    showToast(`–°—Ç–∏–ª—å "${style.name}" –≤—ã–±—Ä–∞–Ω!`);
                    
                    // –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏
                    updateSendButton();
                });
                
                stylesGrid.appendChild(card);
            });
        }

        // –û–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
        function updateSendButton() {
            const inputText = document.getElementById('inputText').value.trim();
            const mainBtn = document.getElementById('mainBtn');
            
            if (inputText && WebApp) {
                mainBtn.disabled = false;
                WebApp.MainButton.show();
            } else {
                mainBtn.disabled = true;
                if (WebApp) WebApp.MainButton.hide();
            }
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Telegram
        function sendDataToTelegram() {
            if (!WebApp) {
                showToast("–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Telegram!");
                return;
            }
            
            const inputText = document.getElementById('inputText').value.trim();
            if (!inputText) {
                showToast("–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏!");
                return;
            }
            
            const transformed = fontStyles[selectedStyle].transform(inputText);
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
            const sendData = {
                text: inputText,
                result: transformed,
                style: selectedStyle,
                styleName: fontStyles[selectedStyle].name
            };
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É
            WebApp.sendData(JSON.stringify(sendData));
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—Ç–ø—Ä–∞–≤–∫–µ
            showToast("‚úÖ –¢–µ–∫—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ —á–∞—Ç!");
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É
            setTimeout(() => {
                if (WebApp) WebApp.close();
            }, 1200);
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–º—ã –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
        function initTheme() {
            if (!WebApp) {
                // –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–Ω–µ Telegram
                document.documentElement.style.setProperty('--tg-theme-bg-color', '#f5f7fb');
                document.documentElement.style.setProperty('--tg-theme-text-color', '#222222');
                document.documentElement.style.setProperty('--tg-theme-hint-color', '#8a8a8a');
                document.documentElement.style.setProperty('--tg-theme-link-color', '#2678b6');
                document.documentElement.style.setProperty('--tg-theme-button-color', '#2678b6');
                document.documentElement.style.setProperty('--tg-theme-button-text-color', '#ffffff');
                return;
            }
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É –∏–∑ Telegram
            document.documentElement.style.setProperty('--tg-theme-bg-color', WebApp.themeParams.bg_color || '#ffffff');
            document.documentElement.style.setProperty('--tg-theme-text-color', WebApp.themeParams.text_color || '#222222');
            document.documentElement.style.setProperty('--tg-theme-hint-color', WebApp.themeParams.hint_color || '#999999');
            document.documentElement.style.setProperty('--tg-theme-link-color', WebApp.themeParams.link_color || '#2678b6');
            document.documentElement.style.setProperty('--tg-theme-button-color', WebApp.themeParams.button_color || '#2678b6');
            document.documentElement.style.setProperty('--tg-theme-button-text-color', WebApp.themeParams.button_text_color || '#ffffff');
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–º—ã –¥–ª—è —Ç–µ–º–Ω–æ–π/—Å–≤–µ—Ç–ª–æ–π —Å—Ö–µ–º—ã
            const isDark = WebApp.colorScheme === 'dark';
            if (isDark) {
                document.documentElement.setAttribute('data-theme', 'dark');
                document.getElementById('theme-color').content = WebApp.themeParams.bg_color || '#17181a';
            } else {
                document.documentElement.removeAttribute('data-theme');
                document.getElementById('theme-color').content = WebApp.themeParams.bg_color || '#ffffff';
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–º–µ–Ω–µ —Ç–µ–º—ã
            WebApp.onEvent('themeChanged', initTheme);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã
            initTheme();
            
            // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
            const inputTextEl = document.getElementById('inputText');
            const mainBtn = document.getElementById('mainBtn');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∏–ª–µ–π
            renderStyleCards();
            
            // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å —Ç–µ–∫—Å—Ç–æ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            updatePreview();
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞
            inputTextEl.addEventListener('input', () => {
                updatePreview();
                updateSendButton();
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
            mainBtn.addEventListener('click', sendDataToTelegram);
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram MainButton
            if (WebApp) {
                WebApp.MainButton.text = 'üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ —á–∞—Ç';
                WebApp.MainButton.color = WebApp.themeParams.button_color || '#2678b6';
                WebApp.MainButton.textColor = WebApp.themeParams.button_text_color || '#ffffff';
                WebApp.MainButton.onClick(sendDataToTelegram);
                
                // –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É, –µ—Å–ª–∏ –µ—Å—Ç—å —Ç–µ–∫—Å—Ç
                if (inputTextEl.value.trim()) {
                    WebApp.MainButton.show();
                } else {
                    WebApp.MainButton.hide();
                }
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—É—Å–∫–∞ (–Ω–∞—á–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç)
                try {
                    const initDataUnsafe = WebApp.initDataUnsafe;
                    if (initDataUnsafe?.start_param) {
                        try {
                            const params = JSON.parse(decodeURIComponent(initDataUnsafe.start_param));
                            if (params.text) {
                                inputTextEl.value = params.text;
                                updatePreview();
                            }
                        } catch (e) {
                            // –ï—Å–ª–∏ –Ω–µ JSON, —Å—á–∏—Ç–∞–µ–º —á—Ç–æ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç
                            inputTextEl.value = decodeURIComponent(initDataUnsafe.start_param);
                            updatePreview();
                        }
                    }
                } catch (e) {
                    console.log('–ù–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—É—Å–∫–∞');
                }
                
                // –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –≤—Å—é –≤—ã—Å–æ—Ç—É
                WebApp.expand();
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è "–ù–∞–∑–∞–¥" –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Telegram
                if (WebApp.BackButton) {
                    WebApp.BackButton.show();
                    WebApp.BackButton.onClick(() => WebApp.close());
                }
            } else {
                // –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–Ω–µ Telegram
                mainBtn.innerHTML = '‚ú® –†–µ–∂–∏–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ (–Ω–µ –≤ Telegram)';
                mainBtn.style.background = 'linear-gradient(90deg, #667eea, #764ba2)';
                mainBtn.disabled = true;
                
                const hint = document.createElement('div');
                hint.style.backgroundColor = 'rgba(255, 235, 59, 0.2)';
                hint.style.color = '#5d4037';
                hint.style.padding = '12px';
                hint.style.borderRadius = '12px';
                hint.style.marginTop = '12px';
                hint.style.fontSize = '14px';
                hint.style.textAlign = 'center';
                hint.innerHTML = '<strong>‚ÑπÔ∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> –ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ Telegram —á–µ—Ä–µ–∑ –±–æ—Ç–∞.';
                document.querySelector('.footer').appendChild(hint);
            }
            
            // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ "–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ" –ø–æ–≤–µ–¥–µ–Ω–∏—è —Å–∫—Ä–æ–ª–ª–∞ –≤ iOS
            let startY = 0;
            document.body.addEventListener('touchstart', (e) => {
                startY = e.touches[0].clientY;
            }, { passive: true });
            
            document.body.addEventListener('touchmove', (e) => {
                const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
                const clientY = e.touches[0].clientY;
                
                if ((scrollTop === 0 && clientY > startY) || 
                    (scrollTop + window.innerHeight >= document.body.scrollHeight && clientY < startY)) {
                    e.preventDefault();
                }
            }, { passive: false });
            
            // –û–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
            updateSendButton();
        });
    </script>
</body>
</html>

